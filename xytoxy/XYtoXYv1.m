%% 平面坐标四参数转换时的病态矩阵问题探讨?
%% 以下计算将坐标值进行了中心化处理
clear

XY = [1,3808260.999,40423578.211,1200.000,885.000;
      2,3811317.151,40425135.398,1200.000,4315.000]

BL = [1, 0, -1528.07600000035,  778.593499995768, 0;
      0, 1, -778.593499995768, -1528.07600000035, -1715;
      1, 0,  1528.07599999988, -778.593500003219, 0;
      0, 1,  778.593500003219,  1528.07599999988, 1715];

B = BL(:, 1:4)
l = BL(:, 5)

N = B'*B

C2 = cond(N)      %%2-范数，   此处运算值为 C2 = 2941224.10013783 ， 有所改善，但仍然很大
C1 = cond(N, 1)   %%1-范数，   此处运算值为 C1 = 2941224.10001782 ， 有所改善，但仍然很大
C8 = cond(N, Inf) %%Inf-范数， 此处运算值为 C8 = 2941224.10001782 ， 有所改善，但仍然很大

U = B'*l

X = N \ U %% 有矩阵病态问题存在?

K=sqrt(X(3)*X(3) + X(4)*X(4))